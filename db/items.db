DROP TABLE users;
DROP TABLE categories;
DROP TABLE items;
DROP TABLE exchange_history;


CREATE TABLE users(
  user_uuid text primary key, 
  user_id text unique, 
  password text
);

CREATE TABLE items(
  item_uuid integer primary key, 
  item_name text, 
  category_id integer, 
  is_public integer, 
  price integer, 
  on_sale integer,
  image text,
  exchange_items integer,
  user_uuid integer,
  FOREIGN KEY (category_id) REFERENCES categories(category_id),
  FOREIGN KEY (user_uuid) REFERENCES users(user_uuid)
);

CREATE TABLE categories(
  category_id integer primary key,
  category_name text
);

CREATE TABLE exchange_history(
  item_uuid integer,
  history_seq integer,
  candidate_item_uuid integer,
  status text,
  buyer_uuid integer,
  primary key(item_uuid, history_seq, buyer_uuid),
  FOREIGN KEY (item_uuid) REFERENCES items(item_uuid),
  FOREIGN KEY (candidate_item_uuid) REFERENCES users(user_uuid),
  FOREIGN KEY (buyer_uuid) REFERENCES users(user_uuid)
);

INSERT INTO categories VALUES(1, 'fashion');
INSERT INTO categories VALUES(2, 'furniture');
INSERT INTO categories VALUES(3, 'kitchen');
INSERT INTO items VALUES(1, 'jacket', 1, 1, 1000, 1, '../images/default.jpg', 0, 1);
INSERT INTO items VALUES(2, 'shirt', 1, 0, 2000, 1, '../images/default.jpg', 0, 1);